<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="revised" content="Ningxia Seasons, 2015/8/13/" />
<!-- 定义页面的最新版本 -->
<meta name="description" content="网站简介" />
<!-- 网站简介 -->
<meta name="keywords" content="搜索关键字，以半角英文逗号隔开" />
<!-- 搜索关键字 -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>智学网课</title>

<!-- Bootstrap -->
<link href="./pro/css/crowdfunding.center/my_info.css" rel="stylesheet">

<!--[if lt IE 9]>
      <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- 开始 -->
<div class="my_info_title">修改密码</div>
<div class="my_info_title_3">
  <ul>
    <li id="listClick_1"  onclick="listjump(1)" >基本资料</li>
    <li id="listClick_3" onclick="listjump(2)">身份认证</li>
    <li id="listClick_4" onclick="listjump(3)" style="border-bottom: 1px solid #C40521; color: #C40521;">修改密码</li>
  </ul>
</div>
<div class="my_info_content">
  <div class="my_info_content_care">感谢您对智学网课平台的信任和支持！</div>
  <table class="my_info_content_care_table">
    <tbody>
      <tr>
        <td width="300" align="right" class="color555">旧密码：</td>
        <td class="color555"><input class="my_info_content_care_table_text"id="oldps" type="text">
          <span class="colorCA1E37 margin_left10 font_size12">请输入旧密码</span></td>
      </tr>
      <tr>
        <td align="right" class="color555">新密码：</td>
        <td class="color555"><input class="my_info_content_care_table_text" id="newone" type="text">
          <span class="colorCA1E37 margin_left10 font_size12">请输入新密码</span></td>
      </tr>
      <tr>
        <td align="right" class="color555">确认新密码：</td>
        <td class="color555"><input class="my_info_content_care_table_text" id="newtwo" type="text">
          <span class="colorCA1E37 margin_left10 font_size12">请再次输入</span></td>
      </tr>
      <!--<tr>-->
        <!--<td align="right" class="color555">验证码：</td>-->
        <!--<td class="color555"><input class="my_info_content_care_table_text" name="" type="text">-->
            <!--<span class="color959595 margin_left10 font_size12">请输入验证码</span></td>-->
      <!--</tr>-->
      <tr>
        <td align="center" class="color555" colspan="2"><input class="my_info_content_care_table_submit" name="" onclick="updatepwd()" type="button" value="确认修改"></td>
      </tr>
    </tbody>
  </table>
</div>
<script src="./assets/js/jquery-3.3.1.js"></script>
<script>
    function listjump(data) {
        if(data==1){
            window.location.href='my_info.html'
        }
        if(data==2){
            window.location.href='identity_prove.html'
        }
        if(data==3){
            window.location.href='make_password.html'
        }
    }
    function updatepwd() {
        var newone=$("#newone").val()
        var newtwo=$("#newtwo").val()
        if(newone==newtwo){
            $.ajax({
                url:'/CheckUser',
                dataType:'json',
                success:function (data) {
                    var num=data.user_phonenumber
                    var olrpwd=$("#oldps").val()
                    $.ajax({
                        url: '/LoginServlet?user_phonenumber=' + num + "&&user_password=" + olrpwd,
                        dataType:'json',
                        success: function (data) {
                            if(data.one=='no'){
                                alert('旧密码错误')
                            }
                            else {
                                $.ajax({
                                    url:'/ReplacePasswordServlet?user_phonenumber='+num+'&&user_password='+newtwo,
                                    dataType:'json',
                                    success:function (data) {
                                        if(data.one=='yes'){
                                            alert("修改成功")
                                        }
                                        if(data.one=='no'){
                                            alert("修改失败")
                                        }
                                    }
                                })
                            }
                        }
                    })
                }
            })
        }else {
            alert("新密码不一致")
        }

    }
</script>
</body>
</html>